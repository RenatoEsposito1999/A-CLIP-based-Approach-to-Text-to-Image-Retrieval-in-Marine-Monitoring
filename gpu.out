Train dataset
---------------
turtle:  21412
debris:  544
sea:  3755
dolphine:  484
furniture 3032
animal 4442
person 6834
vehicle 3746
kitchen 1779
electronic 1376
indoor 1952
appliance 891
food 2025
sports 2701
accessory 1664
outdoor 1667
---------------
Val dataset
turtle:  2677
debris:  68
sea:  469
dolphine:  60
furniture 396
animal 594
person 852
vehicle 446
kitchen 220
electronic 149
indoor 249
appliance 120
food 244
sports 324
accessory 204
outdoor 216
---------------
3644
START TRAINING
┏━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━┓
┃   ┃ Name        ┃ Type                      ┃ Params ┃ Mode  ┃
┡━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━┩
│ 0 │ img_encoder │ ImageEncoder              │ 22.1 M │ train │
│ 1 │ txt_encoder │ TextEncoder               │ 22.7 M │ train │
│ 2 │ loss_fn     │ SupervisedContrastiveLoss │      0 │ train │
└───┴─────────────┴───────────────────────────┴────────┴───────┘
Trainable params: 14.4 M                                                                                                                                
Non-trainable params: 30.4 M                                                                                                                            
Total params: 44.8 M                                                                                                                                    
Total estimated model params size (MB): 179                                                                                                             
Modules in train mode: 204                                                                                                                              
Modules in eval mode: 120                                                                                                                               
oooooooo
[tensor([[[[ 0.5193,  0.5364,  0.5536,  ...,  0.4508,  0.4851,  0.5193],
          [ 0.5364,  0.5193,  0.5707,  ...,  0.4679,  0.4851,  0.5193],
          [ 0.5193,  0.5364,  0.5707,  ...,  0.4851,  0.4851,  0.4851],
          ...,
          [ 0.6906,  0.6906,  0.6906,  ...,  0.6049,  0.6563,  0.6734],
          [ 0.6563,  0.6734,  0.7077,  ...,  0.6221,  0.6392,  0.6563],
          [ 0.6392,  0.6392,  0.6906,  ...,  0.5878,  0.5878,  0.5878]],

         [[ 1.1155,  1.1155,  1.0980,  ...,  1.0805,  1.0455,  1.0280],
          [ 1.0980,  1.0980,  1.0980,  ...,  1.0455,  1.0280,  1.0280],
          [ 1.1331,  1.1331,  1.0805,  ...,  1.0280,  1.0105,  1.0280],
          ...,
          [ 1.1331,  1.1331,  1.1331,  ...,  1.0455,  1.0105,  1.0455],
          [ 1.1681,  1.1681,  1.1331,  ...,  1.0630,  1.0455,  1.0455],
          [ 1.1681,  1.1506,  1.1331,  ...,  1.0630,  1.0630,  1.0455]],

         [[ 2.0300,  2.0300,  2.0300,  ...,  1.9428,  1.8905,  1.8905],
          [ 2.0300,  2.0125,  2.0300,  ...,  1.8731,  1.8731,  1.9080],
          [ 2.0474,  2.0300,  2.0125,  ...,  1.9428,  1.9080,  1.9080],
          ...,
          [ 1.8383,  1.8208,  1.8034,  ...,  1.7163,  1.6988,  1.7163],
          [ 1.8208,  1.8034,  1.8034,  ...,  1.7337,  1.7163,  1.7163],
          [ 1.8208,  1.8208,  1.8383,  ...,  1.6988,  1.7163,  1.6988]]],


        [[[ 1.6324,  1.6495,  1.6495,  ..., -2.1179, -2.1179, -2.1179],
          [ 1.6667,  1.6838,  1.6838,  ..., -2.1179, -2.1179, -2.1179],
          [ 1.6838,  1.7009,  1.7009,  ..., -2.1179, -2.1179, -2.1179],
          ...,
          [-1.7069, -1.6898, -1.6727,  ..., -1.7069, -1.7069, -1.7069],
          [-1.7069, -1.6898, -1.6727,  ..., -1.7069, -1.7069, -1.7069],
          [-1.7240, -1.7069, -1.6898,  ..., -1.7412, -1.7412, -1.7412]],

         [[ 1.7983,  1.8158,  1.8158,  ..., -2.0357, -2.0357, -2.0357],
          [ 1.8333,  1.8508,  1.8508,  ..., -2.0357, -2.0357, -2.0357],
          [ 1.8508,  1.8683,  1.8683,  ..., -2.0357, -2.0357, -2.0357],
          ...,
          [-1.6155, -1.5980, -1.5805,  ..., -1.6155, -1.6155, -1.6155],
          [-1.6155, -1.5980, -1.5805,  ..., -1.6155, -1.6155, -1.6155],
          [-1.6331, -1.6155, -1.5980,  ..., -1.6506, -1.6506, -1.6506]],

         [[ 2.0125,  2.0300,  2.0300,  ..., -1.8044, -1.8044, -1.8044],
          [ 2.0474,  2.0648,  2.0648,  ..., -1.8044, -1.8044, -1.8044],
          [ 2.0648,  2.0823,  2.0823,  ..., -1.8044, -1.8044, -1.8044],
          ...,
          [-1.3861, -1.3687, -1.3513,  ..., -1.3861, -1.3861, -1.3861],
          [-1.3861, -1.3687, -1.3513,  ..., -1.3861, -1.3861, -1.3861],
          [-1.4036, -1.3861, -1.3687,  ..., -1.4210, -1.4210, -1.4210]]],


        [[[-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          ...,
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179]],

         [[-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          ...,
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357]],

         [[-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          ...,
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044]]],


        ...,


        [[[-1.2959, -1.5699, -1.6555,  ..., -1.2274, -1.2103, -1.2274],
          [-1.3473, -1.5870, -1.6384,  ..., -1.2445, -1.2445, -1.2274],
          [-1.4329, -1.5528, -1.6042,  ..., -1.2959, -1.2788, -1.2445],
          ...,
          [-1.2103, -1.2274, -1.1760,  ...,  0.6049,  0.5878,  0.6049],
          [-1.2445, -1.2445, -1.2274,  ...,  0.5707,  0.5536,  0.5878],
          [-1.1932, -1.1932, -1.1932,  ...,  0.5364,  0.5364,  0.5022]],

         [[-1.6506, -1.5980, -1.5455,  ..., -1.1078, -1.1253, -1.1604],
          [-1.6331, -1.5980, -1.5455,  ..., -1.0903, -1.1253, -1.1253],
          [-1.6506, -1.5630, -1.5280,  ..., -1.1078, -1.1253, -1.1078],
          ...,
          [-1.5455, -1.5630, -1.5280,  ...,  0.7304,  0.6954,  0.6954],
          [-1.5630, -1.5630, -1.5455,  ...,  0.6954,  0.6604,  0.6954],
          [-1.5805, -1.5630, -1.5455,  ...,  0.6604,  0.6604,  0.6254]],

         [[-1.3687, -1.2119, -1.2816,  ..., -0.8981, -0.8807, -1.0550],
          [-1.3861, -1.3339, -1.2816,  ..., -0.9504, -0.9330, -0.9678],
          [-1.2467, -1.2641, -1.1770,  ..., -1.0027, -0.9330, -0.8807],
          ...,
          [-1.2990, -1.2293, -1.2119,  ...,  1.0191,  1.0017,  1.0539],
          [-1.3687, -1.2990, -1.3513,  ...,  1.0017,  0.9668,  0.9842],
          [-1.1944, -1.2641, -1.2467,  ...,  0.9494,  0.9145,  0.8274]]],


        [[[-0.3541, -0.5596, -1.1418,  ...,  0.1083,  0.1426,  0.1426],
          [-0.3541, -0.5082, -1.0733,  ...,  0.2282,  0.2624,  0.2453],
          [-0.3198, -0.4397, -0.9705,  ...,  0.2796,  0.2796,  0.2796],
          ...,
          [-0.6965, -0.5596, -0.4397,  ...,  1.4269,  1.3413,  1.2385],
          [-0.6965, -0.5424, -0.4568,  ...,  1.5297,  1.3927,  1.3242],
          [-0.7308, -0.5424, -0.5253,  ...,  1.4954,  1.3927,  1.4098]],

         [[-0.1975, -0.4426, -1.1253,  ...,  0.2577,  0.2927,  0.2927],
          [-0.1975, -0.4076, -1.0553,  ...,  0.3803,  0.4153,  0.4153],
          [-0.1800, -0.3375, -0.9678,  ...,  0.4503,  0.4853,  0.4678],
          ...,
          [-0.9153, -0.8277, -0.7577,  ...,  1.3606,  1.2906,  1.1681],
          [-0.8978, -0.8277, -0.7927,  ...,  1.5532,  1.4307,  1.3606],
          [-0.9153, -0.7927, -0.8627,  ...,  1.5882,  1.4832,  1.4832]],

         [[-0.6367, -0.7936, -1.3687,  ...,  0.5485,  0.5834,  0.5834],
          [-0.6018, -0.7413, -1.2816,  ...,  0.6705,  0.7054,  0.7054],
          [-0.5495, -0.6541, -1.1770,  ...,  0.7402,  0.7576,  0.7402],
          ...,
          [-0.8807, -0.7936, -0.6715,  ...,  1.3154,  1.2282,  1.1237],
          [-0.9156, -0.8110, -0.7587,  ...,  1.5768,  1.4548,  1.3677],
          [-0.9504, -0.8284, -0.8458,  ...,  1.6640,  1.5594,  1.5594]]],


        [[[-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507],
          [-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507],
          [-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507],
          ...,
          [-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507],
          [-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507],
          [-1.8507, -1.8507, -1.8507,  ..., -1.8507, -1.8507, -1.8507]],

         [[-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625],
          [-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625],
          [-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625],
          ...,
          [-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625],
          [-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625],
          [-1.7625, -1.7625, -1.7625,  ..., -1.7625, -1.7625, -1.7625]],

         [[-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325],
          [-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325],
          [-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325],
          ...,
          [-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325],
          [-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325],
          [-1.5325, -1.5325, -1.5325,  ..., -1.5325, -1.5325, -1.5325]]]],
       device='cuda:0'), tensor([[ 101, 1037,  102,  ...,    0,    0,    0],
        [ 101, 1037,  102,  ...,    0,    0,    0],
        [ 101, 1037,  102,  ...,    0,    0,    0],
        ...,
        [ 101, 1037,  102,  ...,    0,    0,    0],
        [ 101, 1037,  102,  ...,    0,    0,    0],
        [ 101, 1037,  102,  ...,    0,    0,    0]], device='cuda:0'), tensor([[1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        ...,
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0],
        [1, 1, 1,  ..., 0, 0, 0]], device='cuda:0'), tensor([11,  2, 13, 12,  8,  3,  5,  4, 10,  9, 15,  1,  6,  0,  7, 14],
       device='cuda:0')]
torch.Size([16, 3, 224, 224])
Epoch 0/49                                          0/3644 0:00:00 • -:--:-- 0.00it/s v_num: 18.000 Val_loss: 7.727 Val_batch_acc: 0.007                
                                                                                      category_all_r@1: 0.092 category_all_r@5: 0.244                   
                                                                                      category_focus_r@1: 0.000 category_focus_r@5: 0.014               
